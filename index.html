<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Al Syed Sales Point - Full System</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

<style>
:root {
  --primary:#ff4b9a;
  --primary-dark:#c2185b;
  --bg:#f7f7fb;
  --black:#111;
  --card-bg:#fff;
}
body {
  background:var(--bg);
  font-family:system-ui, sans-serif;
  color:var(--black);
  padding-bottom:70px;
}
.hidden{display:none!important}
.low-stock{color:#ff1744;font-weight:600}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginOverlay" style="position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;z-index:9999;">
  <div style="background:#111;padding:24px;border-radius:16px;color:#fff;width:100%;max-width:360px;">
    <h4 class="text-center mb-2">Al Syed Sales Point</h4>
    <input id="loginEmail" class="form-control mb-2" placeholder="admin or staff">
    <input id="loginPassword" type="password" class="form-control mb-2" placeholder="password">
    <button class="btn w-100" style="background:#ff4b9a" onclick="fakeLogin()">Login</button>
    <small class="d-block text-center mt-2">admin/admin â€¢ staff/staff</small>
  </div>
</div>

<div class="container my-3">
  <h4>Dashboard</h4>
  <div class="row g-3">
    <div class="col-6 col-md-3"><b>Total Products</b><br><span id="metricTotalProducts">0</span></div>
    <div class="col-6 col-md-3"><b>Total Orders</b><br><span id="metricTotalOrders">0</span></div>
    <div class="col-6 col-md-3"><b>Total Sales</b><br><span id="metricTotalSales">0 PKR</span></div>
    <div class="col-6 col-md-3"><b>Low Stock</b><br><span id="metricLowStock">0</span></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ================= STORAGE ================= */
function saveData(){
  localStorage.setItem("asp_products",JSON.stringify(products));
  localStorage.setItem("asp_sales",JSON.stringify(sales));
  localStorage.setItem("asp_orders",JSON.stringify(orders));
  localStorage.setItem("asp_expenses",JSON.stringify(expenses));
}
function loadData(){
  products = JSON.parse(localStorage.getItem("asp_products")) || products;
  sales = JSON.parse(localStorage.getItem("asp_sales")) || [];
  orders = JSON.parse(localStorage.getItem("asp_orders")) || [];
  expenses = JSON.parse(localStorage.getItem("asp_expenses")) || [];
}

/* ================= CLEAN START ================= */
let products = [
 {id:1,name:"Ruby Necklace",category:"Jewelry",purchase:15000,sale:20000,discount:18000,stock:300,sold:0},
 {id:2,name:"Matte Lipstick",category:"Cosmetics",purchase:300,sale:600,discount:450,stock:80,sold:0},
 {id:3,name:"Jewelry Set",category:"Jewelry",purchase:1200,sale:2400,discount:2000,stock:3,sold:0},
 {id:4,name:"Premium Bra Set",category:"Undergarments",purchase:800,sale:1500,discount:1300,stock:5,sold:0},
 {id:5,name:"Cotton Panty Pack",category:"Undergarments",purchase:200,sale:400,discount:350,stock:2,sold:0},
 {id:6,name:"Men Undershirt",category:"Undergarments",purchase:500,sale:900,discount:0,stock:10,sold:0}
];

let sales = [];
let orders = [];
let expenses = [];
let staffLog = [];

let nextSaleId=1;
let nextOrderId=1;
let nextExpenseId=1;
let invoiceCounter=1001;

let currentRole="";
let currentUserName="";

/* ================= LOGIN ================= */
function fakeLogin(){
  const u=loginEmail.value.toLowerCase();
  const p=loginPassword.value.toLowerCase();

  if(u==="admin" && p==="admin"){currentRole="admin";currentUserName="Admin";}
  else if(u==="staff" && p==="staff"){currentRole="staff";currentUserName="Staff";}
  else{alert("Wrong login");return;}

  loadData();
  document.getElementById("loginOverlay").style.display="none";
  renderMetrics();
}

/* ================= METRICS ================= */
function renderMetrics(){
  document.getElementById("metricTotalProducts").innerText=products.length;
  document.getElementById("metricTotalOrders").innerText=orders.length;
  document.getElementById("metricTotalSales").innerText=
    sales.reduce((s,x)=>s+x.total,0).toLocaleString()+" PKR";
  document.getElementById("metricLowStock").innerText=
    products.filter(p=>p.stock<=5).length;
}

/* ================= SECRET RESET ================= */
document.addEventListener("keydown",function(e){
  if(currentRole==="admin" && e.ctrlKey && e.shiftKey && e.key==="R"){
    if(!confirm("RESET ALL SALES DATA?"))return;
    sales=[];orders=[];expenses=[];
    products.forEach(p=>p.sold=0);
    localStorage.clear();
    location.reload();
  }
});
</script>

</body>
</html>
